C51 COMPILER V9.01   TIME_SETTER                                                           12/20/2002 22:02:45 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE TIME_SETTER
OBJECT MODULE PLACED IN time_setter.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE time_setter.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <reg51.h>
   2          sbit forward_btn = P2 ^ 7;  //key8
   3          sbit backward_btn = P2 ^ 6; //key7
   4          sbit t2_btn = P2 ^ 1;      //key2
   5          sbit t1_btn = P2 ^ 0;      //key1
   6          extern void digital_display(int time);
   7          
   8          /**
   9           * @brief Set the time object
  10           *
  11           * @param order 顺序。1:正计时，-1:倒计时
  12           * 
  13           * @return int 计时时间(十进制)
  14           */
  15          int set_time(int order)
  16          {
  17   1          int t1_previous = t1_btn;
  18   1          int t2_previous = t2_btn;
  19   1          // t1个位，t2十位
  20   1          int t1_count = 0;
  21   1          int t2_count = 0;
  22   1      
  23   1          while (1)
  24   1          {
  25   2              /* 个位 */
  26   2              if (t1_btn ^ t1_previous == 1) // 如果t1状态发生改变
  27   2              {
  28   3                  t1_previous = !t1_previous; // t1_previous取反
  29   3                  t1_count++;                 //更新t1数值
  30   3      
  31   3                  if (t1_count > 9)
  32   3                  {
  33   4                      t1_count = 0; //若超过9则归0
  34   4                  }
  35   3                  digital_display(t1_count + t2_count * 10); //刷新显示
  36   3              }
  37   2      
  38   2              /* 十位 */
  39   2              if (t2_btn ^ t2_previous == 1) // 如果t2状态发生改变(和上面一样，暂时不知道咋么复用)
  40   2              {
  41   3                  t2_previous = !t2_previous; // t2_previous取反
  42   3                  t2_count++;                 //更新t2数值
  43   3      
  44   3                  if (t2_count > 9)
  45   3                  {
  46   4                      t2_count = 0; //若超过9则归0
  47   4                  }
  48   3                  digital_display(t1_count + t2_count * 10); //刷新显示
  49   3              }
  50   2      
  51   2              /* 按下确认按键后退出设置 */
  52   2              if (order==1 & forward_btn==0)
  53   2              {
  54   3                  break;
  55   3              }
C51 COMPILER V9.01   TIME_SETTER                                                           12/20/2002 22:02:45 PAGE 2   

  56   2                      if (order==-1 & backward_btn==0)
  57   2              {
  58   3                  break;
  59   3              }
  60   2      
  61   2          }
  62   1          return t1_count + 10 * t2_count;
  63   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    278    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      10
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
